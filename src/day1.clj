(ns day1)

(def input "+13\n-7\n-17\n+12\n-11\n+19\n+18\n+19\n-8\n+11\n+7\n-3\n+7\n-1\n-16\n+11\n-2\n-2\n+20\n+1\n+17\n+15\n+4\n-1\n+7\n+3\n+17\n+13\n-8\n+15\n+18\n-12\n+3\n-4\n-14\n+6\n-7\n+8\n-9\n+12\n+7\n+2\n-8\n-19\n-12\n+11\n+13\n+4\n+13\n+11\n+19\n+14\n-12\n-19\n+1\n-10\n+20\n-8\n-15\n+2\n+7\n-5\n+10\n+7\n+19\n-5\n+11\n-4\n+15\n+18\n+13\n+10\n+1\n+2\n+6\n+20\n+5\n-10\n-2\n-2\n+12\n-11\n-13\n-13\n+16\n+17\n+17\n-18\n-13\n-17\n+19\n-3\n-11\n-19\n+1\n-13\n-6\n-5\n-19\n+9\n+1\n+18\n-7\n-13\n+3\n-14\n-10\n+18\n+17\n+16\n+9\n+3\n+7\n-12\n+6\n+7\n-19\n-5\n-8\n-1\n-13\n+8\n-3\n-22\n-17\n-16\n-11\n+18\n-14\n-15\n-17\n-18\n+9\n-10\n+14\n+14\n+4\n+6\n+2\n+23\n+18\n+1\n+20\n-4\n+12\n+1\n+17\n-3\n+4\n+13\n+7\n+11\n-12\n-21\n-18\n+3\n-27\n-21\n+13\n+13\n-1\n-16\n+6\n+15\n-7\n-11\n+43\n+12\n+2\n+3\n+15\n+8\n+14\n+15\n-16\n-5\n+7\n+18\n+17\n+11\n+3\n+17\n-14\n+13\n+16\n+3\n+19\n-5\n-7\n-12\n+9\n-5\n-5\n+4\n+19\n+9\n-6\n+19\n+1\n+5\n+15\n-10\n+5\n+14\n-4\n-16\n-1\n-12\n-12\n+13\n-8\n+1\n-14\n-8\n-6\n-16\n+6\n+13\n+8\n-12\n+8\n-3\n-16\n+13\n-10\n-14\n-8\n-12\n-9\n+4\n-1\n+10\n+15\n-3\n-15\n+14\n+3\n-22\n-17\n-2\n+11\n-1\n-3\n-10\n+11\n-12\n+3\n+5\n+17\n+7\n+3\n-18\n-22\n-7\n-17\n+19\n+15\n+19\n+17\n-12\n+9\n-1\n+11\n+11\n-6\n-2\n+1\n+27\n-15\n+22\n+10\n+16\n+10\n+18\n-1\n-4\n+9\n+19\n+15\n+13\n-16\n-7\n+18\n+7\n-19\n-1\n-3\n-11\n-1\n-1\n+14\n+6\n-10\n+16\n+19\n+4\n-18\n-22\n+16\n+18\n+13\n-1\n-20\n+16\n+10\n+13\n-2\n-5\n-15\n-2\n-4\n+14\n-16\n-7\n-5\n-8\n+6\n+9\n+2\n-14\n-8\n-4\n+18\n+9\n-4\n+19\n+30\n+1\n-7\n+11\n+8\n+5\n-8\n+9\n-7\n+16\n+17\n+5\n+9\n-19\n+14\n+17\n-8\n+13\n+3\n-12\n+10\n+4\n-7\n-18\n+12\n+14\n+16\n+11\n+8\n-1\n-8\n-17\n-6\n+4\n+10\n+3\n-10\n+5\n-9\n-24\n-4\n+13\n-1\n+3\n-14\n+5\n+4\n-12\n-6\n-6\n+16\n-20\n-34\n-1\n-12\n+19\n-18\n-8\n-13\n-4\n+10\n+16\n-4\n-2\n+1\n+7\n+17\n-13\n+6\n+16\n+14\n+18\n+21\n+29\n-1\n-3\n-34\n-16\n-15\n-27\n-5\n-8\n+19\n+7\n+10\n+15\n+2\n-7\n+11\n-12\n-21\n-20\n+19\n+11\n+3\n+6\n-52\n-13\n+3\n-43\n-19\n-6\n-4\n-20\n-6\n+9\n-5\n+3\n+17\n-11\n-17\n-15\n-16\n-7\n+12\n+5\n+11\n+4\n-14\n-12\n+10\n+20\n+7\n+17\n-19\n-10\n+6\n-18\n-9\n+10\n+24\n+20\n-2\n+1\n+7\n-11\n+10\n+8\n-4\n-15\n-11\n-20\n-1\n-18\n-13\n+2\n-25\n-21\n+10\n+12\n-49\n+13\n-4\n-7\n+17\n+14\n+17\n-85\n+8\n-5\n+16\n+5\n+17\n-59\n-4\n-17\n-28\n-47\n+27\n-7\n+16\n-66\n+7\n-16\n-1\n-134\n+22\n+2\n-31\n+8\n+11\n-54\n+7\n-5\n+21\n-31\n-4\n-14\n+12\n+31\n-14\n-218\n-82\n-71530\n+7\n+11\n+4\n-10\n-18\n+5\n-19\n-4\n-11\n+4\n+9\n+1\n-13\n+7\n+17\n+16\n-8\n-6\n+5\n+14\n+2\n+2\n-1\n-9\n-19\n-19\n-4\n+18\n+14\n+6\n-8\n+3\n-8\n-1\n-3\n+19\n+17\n+11\n+14\n+17\n+6\n+14\n-4\n+15\n-7\n+18\n+10\n+15\n-10\n+1\n+5\n-19\n+7\n-16\n-18\n+2\n-16\n+18\n+8\n-6\n+10\n-1\n+9\n+5\n-19\n+9\n+13\n-6\n-18\n-12\n-14\n-7\n-15\n+7\n-20\n-5\n+11\n+12\n+3\n-20\n-18\n+10\n+17\n-3\n+1\n-9\n+15\n+3\n-6\n-20\n+13\n+5\n-12\n-13\n-25\n-2\n-13\n+1\n-16\n-17\n+12\n+18\n-11\n+15\n+19\n+11\n+2\n+4\n+16\n+14\n+26\n+2\n-6\n-12\n+2\n+1\n+5\n+1\n+1\n+14\n+4\n-13\n-21\n+7\n+3\n+25\n+19\n+11\n-6\n-2\n+19\n+4\n+6\n+2\n-18\n+11\n+22\n+16\n-10\n-3\n+18\n+8\n+14\n+15\n+10\n+8\n-3\n+12\n-8\n-7\n-3\n-12\n+2\n+7\n+16\n+13\n-12\n+15\n-18\n+4\n-16\n-4\n-13\n+10\n+4\n+20\n-4\n+13\n-17\n-3\n-12\n-14\n-7\n+9\n-3\n+9\n-1\n+3\n-24\n+4\n+2\n-10\n+19\n+24\n-10\n-11\n-6\n+21\n-23\n-22\n-5\n+10\n-7\n+8\n-21\n+7\n-13\n+10\n+13\n-18\n-6\n+12\n+1\n-4\n-5\n+15\n-25\n-1\n-2\n+6\n-2\n+3\n+27\n-22\n-4\n-62\n+8\n+12\n-29\n+21\n-19\n-44\n-13\n+12\n-68\n+2\n+12\n+1\n-17\n-5\n-16\n-11\n-14\n+5\n-8\n-8\n+12\n-9\n-1\n-11\n-14\n+6\n+13\n-12\n+14\n+15\n-18\n+10\n-4\n-4\n+18\n+7\n+17\n+4\n-13\n+11\n+9\n-2\n-6\n-13\n+2\n+15\n-13\n-19\n-8\n+13\n+1\n-2\n+10\n-2\n-19\n-3\n-14\n-17\n+14\n-18\n+19\n-10\n-15\n-2\n+6\n-1\n+16\n-18\n-5\n-11\n+4\n+13\n-7\n-15\n-11\n-14\n+6\n+17\n+3\n-7\n-16\n-2\n-7\n-7\n-1\n+18\n+20\n+13\n-10\n-19\n-10\n+12\n+7\n-15\n+7\n+6\n+3\n+13\n+1\n-4\n+11\n-17\n-9\n-20\n-12\n-15\n+10\n-1\n-5\n-12\n-15\n+18\n-16\n+19\n-17\n-10\n+18\n+2\n+14\n-2\n-21\n-16\n-4\n-4\n-3\n+2\n-9\n+1\n+5\n-19\n+10\n+6\n+8\n-7\n-12\n-9\n+11\n+18\n+18\n-5\n-20\n+19\n-7\n+10\n-5\n-7\n-17\n-5\n-4\n-3\n-5\n+21\n+18\n+8\n-9\n-6\n+3\n-8\n-17\n-15\n+19\n-5\n-8\n-2\n-1\n+20\n-38\n+5\n+12\n-34\n-17\n-16\n+18\n-10\n+7\n+17\n-18\n+7\n-16\n+7\n+10\n-33\n+6\n-27\n+1\n+6\n-4\n-4\n-5\n-2\n-9\n-5\n-1\n+18\n-6\n-19\n-18\n-14\n-29\n-64\n-25\n-16\n-11\n-3\n-11\n-11\n-23\n+17\n-4\n-18\n+3\n-4\n-14\n+12\n+18\n-5\n+73044")

;; part-one fns
(defn parse-int [x]
  (Integer/parseInt x))

(defn parse-it [x]
  (->> (clojure.string/split input #"\n")
       (map parse-int)))

;; part-one
(->> input
     (parse-it)
     (reduce +))

;; part-two fns
(defn freqs [in]
  (reductions + (cycle in)))

(defn find-first-reached-twice [coll]
  (reduce (fn [xs y]
            (if (contains? xs y)
              (reduced y)
              (conj xs y))) #{} coll))

;; part-two
(->> input
     (parse-it)
     (freqs)
     (find-first-reached-twice))
